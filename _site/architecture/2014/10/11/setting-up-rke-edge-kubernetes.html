<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Setting up RKE (Rancher Kubernetes Engine) for Edge Devices</title>
  <meta name="description" content="Rancher Kubernetes Engine (RKE) is a Kubernetes installer that simplifies the deployment of Kubernetes clusters in various environments. RKE is known for its ease of use and compatibility with mult..." />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@pypycodes" />
    <meta name="twitter:title" content="Setting up RKE (Rancher Kubernetes Engine) for Edge Devices" />
    <meta name="twitter:image" content="http://localhost:4000/assets/images/df_logo.jpg" />
    
    <meta name="twitter:description"  content="Rancher Kubernetes Engine (RKE) is a Kubernetes installer that simplifies the deployment of Kubernetes clusters in various environments. RKE is known for its ease of use and compatibility with mult..." />
    
  
  
  <meta property="og:site_name" content="IT Architect's Blog" />
  <meta property="og:title" content="Setting up RKE (Rancher Kubernetes Engine) for Edge Devices"/>
  
  <meta property="og:description" content="Rancher Kubernetes Engine (RKE) is a Kubernetes installer that simplifies the deployment of Kubernetes clusters in various environments. RKE is known for its ease of use and compatibility with mult..." />
  
  <meta property="og:image" content="http://localhost:4000/assets/images/df_logo.jpg" />
  <meta property="og:url" content="http://localhost:4000/architecture/2014/10/11/setting-up-rke-edge-kubernetes.html" >
  <meta property="og:type" content="blog" />
  <meta property="article:published_time" content="2014-10-11T15:30:00+05:30">

  <link rel="canonical" href="http://localhost:4000/architecture/2014/10/11/setting-up-rke-edge-kubernetes.html"/>
  <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png"/>
  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->


  <a href="http://localhost:4000" class="logo-readium"><span class="logo" style="background-image: url(/assets/images/df_logo.jpg)"></span></a>

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Setting up RKE (Rancher Kubernetes Engine) for Edge Devices</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url('/assets/images/author.jpg')">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person"></h4>
              on
              <time datetime="2014-10-11T15:30:00+05:30">11 Oct 2014</time>
              <!-- , tagged on <span class="post-tag-">, <a href="/tag/"></a></span> -->
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>Rancher Kubernetes Engine (RKE) is a Kubernetes installer that simplifies the deployment of Kubernetes clusters in various environments. RKE is known for its ease of use and compatibility with multiple platforms, including on-premises servers and cloud environments. This guide will take you through setting up a Kubernetes cluster with RKE on Linux servers.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>Before you begin, ensure you have:</p>

<ul>
  <li><strong>Three or more Linux servers</strong> (Ubuntu 20.04 or newer is preferred) with at least 2 GB of RAM and 2 vCPUs each.</li>
  <li><strong>Sudo access</strong> on each server.</li>
  <li><strong>Access to the internet</strong> for downloading necessary software.</li>
  <li><strong>Docker</strong> installed on each server. If Docker is not installed, follow the instructions in Step 1.</li>
</ul>

<h2 id="step-1-prepare-the-servers">Step 1: Prepare the Servers</h2>

<h3 id="11-install-docker">1.1 Install Docker</h3>

<p>If Docker is not already installed, use the following commands to set it up on each server:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-fsSL</span> https://get.docker.com | sh
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>docker <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>systemctl start docker
</code></pre></div></div>

<p>Verify Docker installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nt">--version</span>
</code></pre></div></div>

<h3 id="12-disable-swap">1.2 Disable Swap</h3>

<p>Kubernetes requires swap to be disabled for stable operation. Run the following command to temporarily disable swap:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>swapoff <span class="nt">-a</span>
</code></pre></div></div>

<p>To disable swap permanently, open the <code class="language-plaintext highlighter-rouge">/etc/fstab</code> file and comment out any swap entries.</p>

<h3 id="13-configure-firewall-optional">1.3 Configure Firewall (Optional)</h3>

<p>If you have a firewall enabled, make sure to allow traffic on the necessary ports for Kubernetes:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Allow traffic on port 6443 for Kubernetes API</span>
<span class="nb">sudo </span>ufw allow 6443

<span class="c"># Allow traffic for communication between nodes (ports 2379, 2380, 10250, 10255, etc.)</span>
<span class="nb">sudo </span>ufw allow 2379:2380/tcp
<span class="nb">sudo </span>ufw allow 10250:10255/tcp
</code></pre></div></div>

<h2 id="step-2-install-rke">Step 2: Install RKE</h2>

<ol>
  <li>
    <p><strong>Download the RKE Binary</strong><br />
On your local machine, download the latest RKE binary:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://github.com/rancher/rke/releases/download/v1.3.13/rke_linux-amd64 <span class="nt">-O</span> rke
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Make the RKE Binary Executable</strong><br />
Change the permissions to make the file executable:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x rke
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Move RKE to a System Path</strong><br />
To access RKE from anywhere, move it to <code class="language-plaintext highlighter-rouge">/usr/local/bin</code>:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo mv </span>rke /usr/local/bin/
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Verify Installation</strong><br />
Confirm the installation by checking the RKE version:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rke <span class="nt">--version</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="step-3-configure-the-cluster">Step 3: Configure the Cluster</h2>

<h3 id="31-create-a-cluster-configuration-file">3.1 Create a Cluster Configuration File</h3>

<ol>
  <li>
    <p><strong>Generate the Cluster Configuration</strong><br />
On your local machine, run the following command to generate a cluster configuration file (<code class="language-plaintext highlighter-rouge">cluster.yml</code>):</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rke config <span class="nt">--name</span> cluster.yml
</code></pre></div>    </div>

    <p>Follow the prompts to specify the details of your cluster. You will need to provide the IP addresses of your nodes, set roles (etcd, controlplane, worker), and optionally define SSH keys or passwords for accessing each node.</p>
  </li>
  <li>
    <p><strong>Edit the <code class="language-plaintext highlighter-rouge">cluster.yml</code> Configuration</strong><br />
Once the file is generated, you can manually edit the <code class="language-plaintext highlighter-rouge">cluster.yml</code> file to make any adjustments. The file should include at least one etcd node, one control plane node, and one or more worker nodes.</p>

    <p>Here’s an example configuration for a simple three-node cluster:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">nodes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">address</span><span class="pi">:</span> <span class="s">192.168.1.101</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s">ubuntu</span>
    <span class="na">role</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">etcd</span><span class="pi">,</span> <span class="nv">controlplane</span><span class="pi">,</span> <span class="nv">worker</span><span class="pi">]</span>
    <span class="na">ssh_key_path</span><span class="pi">:</span> <span class="s">~/.ssh/id_rsa</span>

  <span class="pi">-</span> <span class="na">address</span><span class="pi">:</span> <span class="s">192.168.1.102</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s">ubuntu</span>
    <span class="na">role</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">worker</span><span class="pi">]</span>
    <span class="na">ssh_key_path</span><span class="pi">:</span> <span class="s">~/.ssh/id_rsa</span>

  <span class="pi">-</span> <span class="na">address</span><span class="pi">:</span> <span class="s">192.168.1.103</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s">ubuntu</span>
    <span class="na">role</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">worker</span><span class="pi">]</span>
    <span class="na">ssh_key_path</span><span class="pi">:</span> <span class="s">~/.ssh/id_rsa</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="32-validate-node-access">3.2 Validate Node Access</h3>

<p>Ensure that you can SSH into each node without needing to enter a password, as RKE relies on SSH for deployment. Test SSH access with the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh ubuntu@192.168.1.101
</code></pre></div></div>

<h2 id="step-4-deploy-the-cluster">Step 4: Deploy the Cluster</h2>

<ol>
  <li>
    <p><strong>Run the RKE Deployment</strong><br />
With the <code class="language-plaintext highlighter-rouge">cluster.yml</code> file configured, you can deploy your cluster:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rke up <span class="nt">--config</span> cluster.yml
</code></pre></div>    </div>

    <p>RKE will connect to each node, deploy Kubernetes components, and set up the cluster based on your configuration. The process may take several minutes.</p>
  </li>
  <li>
    <p><strong>Check for Errors</strong><br />
Monitor the output for any errors. If RKE completes successfully, you will see messages indicating that the cluster has been successfully deployed.</p>
  </li>
</ol>

<h2 id="step-5-access-the-cluster">Step 5: Access the Cluster</h2>

<h3 id="51-retrieve-kubeconfig-file">5.1 Retrieve kubeconfig File</h3>

<p>After deployment, RKE generates a <code class="language-plaintext highlighter-rouge">kube_config_cluster.yml</code> file in the same directory. This file is required to access and manage the cluster with <code class="language-plaintext highlighter-rouge">kubectl</code>.</p>

<ol>
  <li>
    <p><strong>Move kubeconfig to .kube Directory</strong><br />
Copy the generated kubeconfig file to your <code class="language-plaintext highlighter-rouge">.kube</code> directory:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/.kube
<span class="nb">cp </span>kube_config_cluster.yml ~/.kube/config
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Verify Cluster Access</strong><br />
Check the cluster status with <code class="language-plaintext highlighter-rouge">kubectl</code>:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get nodes
</code></pre></div>    </div>

    <p>You should see a list of all nodes in the cluster, showing their roles and statuses.</p>
  </li>
</ol>

<h2 id="step-6-testing-the-cluster">Step 6: Testing the Cluster</h2>

<p>To ensure the cluster is functioning correctly, let’s deploy a simple application.</p>

<ol>
  <li>
    <p><strong>Deploy an Nginx Deployment</strong><br />
Run the following command to create an Nginx deployment:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create deployment nginx <span class="nt">--image</span><span class="o">=</span>nginx
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Expose the Nginx Deployment</strong><br />
Expose the deployment as a LoadBalancer service:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl expose deployment nginx <span class="nt">--type</span><span class="o">=</span>LoadBalancer <span class="nt">--port</span><span class="o">=</span>80
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Retrieve the Service Information</strong><br />
Check the service details and obtain the external IP:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get services
</code></pre></div>    </div>

    <p>You can now access Nginx by navigating to the external IP in a browser.</p>
  </li>
</ol>

<h2 id="conclusion">Conclusion</h2>

<p>You have successfully set up a Kubernetes cluster using Rancher Kubernetes Engine! This setup provides a robust, production-grade Kubernetes environment that you can use for development, testing, and deployment. Explore further by deploying different workloads and integrating tools to manage your cluster.</p>

<p>RKE’s flexibility and simplicity make it a popular choice for deploying Kubernetes clusters across diverse environments. With your new cluster, you’re ready to dive into Kubernetes and start deploying containerized applications.</p>

<p>This article should provide a comprehensive and clear overview of setting up an RKE cluster, suitable for anyone looking to get started with Kubernetes in a manageable way. Enjoy working with your RKE-powered Kubernetes cluster!</p>

        </section>
        <footer class="post-footer">
          <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Setting+up+RKE+%28Rancher+Kubernetes+Engine%29+for+Edge+Devices&amp;url=http://localhost:4000/architecture/2014/10/11/setting-up-rke-edge-kubernetes"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url('/assets/images/author.jpg')">Blog Logo</div>
              <h4>Pypycodes</h4>
              <p class="bio"></p>
              <hr>
              <p class="published">Published <time datetime="2014-10-11 15:30">11 Oct 2014</time></p>
            </section>
          </div>
          
          <div class="isRight">
            <h5 class="index-headline featured"><span>Supported by</span></h5>
            <footer class="site-footer">
              <section class="poweredby">Proudly published with <a href="http://jekyllrb.com"> Jekyll</a></section>
              <a class="subscribe" href="/feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> You should subscribe to my feed.</span></a>
              <div class="inner">
                <section class="copyright">All content copyright <a href="/">Pypycodes</a> &copy; 2024<br>All rights reserved.</section>
              </div>
            </footer>
          </div>
        </div>
        
      </article>
    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url('/assets/images/cA4aKEIPQrerBnp1yGHv_IMG_9534-3-2.jpg');">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">IT Architect's Blog</h1>
        <h2 class="blog-description">Blog on IT Architecture, from the latest trends to the best practices.
</h2>
        <a href=/ class="btn">Back to Overview</a>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    
      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 1-Math.max(top/700, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>


  </body>
</html>
